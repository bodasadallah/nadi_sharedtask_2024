
Loading the datasets
`low_cpu_mem_usage` was None, now set to True since model is quantized.






Loading checkpoint shards: 100%|██████████| 6/6 [00:54<00:00,  9.10s/it]
/home/abdelrahman.sadallah/mambaforge/envs/nlp/lib/python3.10/site-packages/transformers/training_args.py:1463: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
Map: 100%|██████████| 400/400 [00:00<00:00, 9690.03 examples/s]
Detected kernel version 5.4.204, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
max_steps is given, it will override any value given in num_train_epochs














  0%|          | 99/100000 [01:17<20:52:25,  1.33it/s]







































  0%|          | 199/100000 [02:36<22:42:54,  1.22it/s]






































  0%|          | 298/100000 [03:52<21:01:27,  1.32it/s]








































  0%|          | 399/100000 [05:11<21:54:39,  1.26it/s]






































  0%|          | 498/100000 [06:28<20:51:25,  1.33it/s]
  0%|          | 500/100000 [06:30<20:32:20,  1.35it/s]















































































100%|█████████▉| 399/400 [02:38<00:00,  2.43it/s]







































  1%|          | 599/100000 [10:28<20:13:46,  1.36it/s]






































  1%|          | 698/100000 [11:44<20:37:07,  1.34it/s]







































  1%|          | 799/100000 [13:03<20:38:57,  1.33it/s]






































  1%|          | 898/100000 [14:18<19:08:13,  1.44it/s]






































  1%|          | 998/100000 [15:35<22:28:42,  1.22it/s]
  1%|          | 1000/100000 [15:36<22:44:55,  1.21it/s]















































































100%|█████████▉| 399/400 [02:38<00:00,  2.41it/s]








































  1%|          | 1098/100000 [19:37<22:05:14,  1.24it/s]







































  1%|          | 1199/100000 [20:55<20:29:39,  1.34it/s]






































  1%|▏         | 1299/100000 [22:12<21:51:00,  1.25it/s]







































  1%|▏         | 1399/100000 [23:29<22:07:45,  1.24it/s]






































  2%|▏         | 1500/100000 [24:46<20:14:11,  1.35it/s]
{'loss': 3.9207, 'grad_norm': 0.8072664737701416, 'learning_rate': 2.142551064133695e-07, 'epoch': 0.03}














































































 99%|█████████▉| 397/400 [02:37<00:01,  2.59it/s]








































  2%|▏         | 1600/100000 [28:46<20:22:34,  1.34it/s]






































  2%|▏         | 1699/100000 [30:02<20:20:42,  1.34it/s]







































  2%|▏         | 1801/100000 [31:20<21:03:40,  1.30it/s]







































  2%|▏         | 1899/100000 [32:38<23:26:06,  1.16it/s]







































  2%|▏         | 1999/100000 [33:56<21:43:02,  1.25it/s]
  2%|▏         | 2000/100000 [33:57<21:30:28,  1.27it/s]















































































 99%|█████████▉| 397/400 [02:37<00:01,  2.69it/s]






































  2%|▏         | 2100/100000 [37:57<20:16:28,  1.34it/s]







































  2%|▏         | 2201/100000 [39:15<20:19:50,  1.34it/s]







































  2%|▏         | 2298/100000 [40:33<21:38:22,  1.25it/s]








































  2%|▏         | 2401/100000 [41:53<20:50:01,  1.30it/s]






































  2%|▎         | 2500/100000 [43:11<20:09:50,  1.34it/s]
  0%|          | 2/400 [00:00<01:14,  5.32it/s]
















































































100%|█████████▉| 398/400 [02:38<00:00,  2.52it/s]







































  3%|▎         | 2599/100000 [47:12<21:12:04,  1.28it/s]






































  3%|▎         | 2699/100000 [48:28<20:40:16,  1.31it/s]







































  3%|▎         | 2800/100000 [49:46<20:32:30,  1.31it/s]






































  3%|▎         | 2899/100000 [51:02<21:02:40,  1.28it/s]






































  3%|▎         | 3000/100000 [52:19<20:13:43,  1.33it/s]
  0%|          | 2/400 [00:00<01:16,  5.21it/s]















































































 99%|█████████▉| 396/400 [02:36<00:01,  2.73it/s]







































  3%|▎         | 3099/100000 [56:22<20:13:02,  1.33it/s]







































  3%|▎         | 3201/100000 [57:41<20:13:32,  1.33it/s]







































  3%|▎         | 3300/100000 [58:58<20:01:52,  1.34it/s]







































  3%|▎         | 3401/100000 [1:00:16<20:18:12,  1.32it/s]





































  4%|▎         | 3500/100000 [1:01:32<25:22:13,  1.06it/s]
  1%|          | 3/400 [00:00<01:43,  3.83it/s]















































































100%|█████████▉| 399/400 [02:39<00:00,  2.40it/s]








































  4%|▎         | 3601/100000 [1:05:35<20:38:45,  1.30it/s]







































  4%|▎         | 3700/100000 [1:06:53<20:52:17,  1.28it/s]






































  4%|▍         | 3800/100000 [1:08:10<20:59:37,  1.27it/s]







































  4%|▍         | 3902/100000 [1:09:28<20:23:01,  1.31it/s]





































  4%|▍         | 4000/100000 [1:10:43<20:00:55,  1.33it/s]
  1%|          | 3/400 [00:00<01:42,  3.89it/s]














































































100%|█████████▉| 398/400 [02:34<00:00,  2.64it/s]






































  4%|▍         | 4101/100000 [1:14:52<20:04:57,  1.33it/s]





































  4%|▍         | 4199/100000 [1:16:06<19:42:49,  1.35it/s]






































  4%|▍         | 4298/100000 [1:17:22<22:38:40,  1.17it/s]






































  4%|▍         | 4397/100000 [1:18:38<19:25:00,  1.37it/s]






































  4%|▍         | 4498/100000 [1:19:54<20:22:17,  1.30it/s]
  4%|▍         | 4500/100000 [1:19:56<19:34:15,  1.36it/s]













































































 99%|█████████▉| 395/400 [02:33<00:01,  2.66it/s]




































  5%|▍         | 4598/100000 [1:23:49<20:26:30,  1.30it/s]






































  5%|▍         | 4699/100000 [1:25:05<20:06:36,  1.32it/s]





































  5%|▍         | 4798/100000 [1:26:19<19:39:05,  1.35it/s]






































  5%|▍         | 4899/100000 [1:27:35<22:51:07,  1.16it/s]





































  5%|▍         | 4998/100000 [1:28:50<20:38:56,  1.28it/s]

  5%|▌         | 5000/100000 [1:28:51<20:20:32,  1.30it/s]
















































































 99%|█████████▉| 397/400 [02:42<00:01,  2.66it/s]









































  5%|▌         | 5099/100000 [1:33:06<20:49:05,  1.27it/s]









































  5%|▌         | 5199/100000 [1:34:28<22:19:13,  1.18it/s]








































  5%|▌         | 5300/100000 [1:35:48<19:38:25,  1.34it/s]







































  5%|▌         | 5399/100000 [1:37:06<20:07:22,  1.31it/s]







































  5%|▌         | 5499/100000 [1:38:24<20:31:46,  1.28it/s]
  6%|▌         | 5500/100000 [1:38:25<20:32:03,  1.28it/s]


















































































 99%|█████████▉| 396/400 [02:43<00:01,  2.56it/s]









































  6%|▌         | 5600/100000 [1:42:38<22:23:37,  1.17it/s]









































  6%|▌         | 5699/100000 [1:44:01<24:53:51,  1.05it/s]










































  6%|▌         | 5800/100000 [1:45:25<22:15:21,  1.18it/s]










































  6%|▌         | 5900/100000 [1:46:49<21:11:17,  1.23it/s]









































  6%|▌         | 5999/100000 [1:48:12<22:35:16,  1.16it/s]
  6%|▌         | 6000/100000 [1:48:12<22:30:34,  1.16it/s]























































































100%|█████████▉| 399/400 [02:54<00:00,  2.15it/s]











































  6%|▌         | 6098/100000 [1:52:35<23:37:54,  1.10it/s]












































  6%|▌         | 6199/100000 [1:54:03<22:03:55,  1.18it/s]











































  6%|▋         | 6298/100000 [1:55:29<21:21:04,  1.22it/s]













































  6%|▋         | 6400/100000 [1:56:59<22:49:36,  1.14it/s]











































  6%|▋         | 6499/100000 [1:58:26<22:26:08,  1.16it/s]
  6%|▋         | 6500/100000 [1:58:27<22:16:00,  1.17it/s]

























































































 99%|█████████▉| 397/400 [02:57<00:01,  2.46it/s]











































  7%|▋         | 6599/100000 [2:02:54<23:16:45,  1.11it/s]











































  7%|▋         | 6699/100000 [2:04:20<22:36:14,  1.15it/s]











































  7%|▋         | 6799/100000 [2:05:46<23:10:15,  1.12it/s]










































  7%|▋         | 6899/100000 [2:07:11<21:49:23,  1.19it/s]










































  7%|▋         | 6999/100000 [2:08:35<21:04:57,  1.23it/s]
  7%|▋         | 7000/100000 [2:08:36<21:31:34,  1.20it/s]





















































































100%|█████████▉| 398/400 [02:49<00:00,  2.58it/s]









































  7%|▋         | 7100/100000 [2:12:54<21:40:33,  1.19it/s]









































  7%|▋         | 7199/100000 [2:14:15<22:03:03,  1.17it/s]










































  7%|▋         | 7299/100000 [2:15:39<21:02:11,  1.22it/s]












































  7%|▋         | 7401/100000 [2:17:08<21:18:47,  1.21it/s]












































  8%|▊         | 7500/100000 [2:18:35<23:05:40,  1.11it/s]
{'loss': 1.242, 'grad_norm': 1.2078971862792969, 'learning_rate': 9.94634350906999e-07, 'epoch': 0.14}























































































 99%|█████████▉| 397/400 [02:53<00:01,  2.41it/s]











































  8%|▊         | 7601/100000 [2:23:02<20:26:47,  1.26it/s]










































  8%|▊         | 7701/100000 [2:24:26<21:14:31,  1.21it/s]











































  8%|▊         | 7800/100000 [2:25:52<21:27:38,  1.19it/s]









































  8%|▊         | 7899/100000 [2:27:15<20:12:58,  1.27it/s]










































  8%|▊         | 7999/100000 [2:28:38<21:30:51,  1.19it/s]
  8%|▊         | 8000/100000 [2:28:39<21:12:59,  1.20it/s]



















































































100%|█████████▉| 398/400 [02:45<00:00,  2.35it/s]









































  8%|▊         | 8100/100000 [2:32:55<21:58:02,  1.16it/s]









































  8%|▊         | 8201/100000 [2:34:17<20:55:27,  1.22it/s]









































  8%|▊         | 8301/100000 [2:35:39<21:59:38,  1.16it/s]










































  8%|▊         | 8400/100000 [2:37:04<22:22:35,  1.14it/s]










































  8%|▊         | 8500/100000 [2:38:28<20:40:40,  1.23it/s]
{'loss': 1.0551, 'grad_norm': 0.8459933996200562, 'learning_rate': 9.838815471134098e-07, 'epoch': 0.16}























































































100%|█████████▉| 399/400 [02:55<00:00,  2.24it/s]












































  9%|▊         | 8600/100000 [2:42:56<21:14:42,  1.20it/s]











































  9%|▊         | 8700/100000 [2:44:23<21:13:30,  1.19it/s]











































  9%|▉         | 8800/100000 [2:45:48<20:15:19,  1.25it/s]










































  9%|▉         | 8898/100000 [2:47:12<21:18:18,  1.19it/s]










































  9%|▉         | 8997/100000 [2:48:36<21:25:20,  1.18it/s]

  9%|▉         | 9000/100000 [2:48:38<22:13:17,  1.14it/s]























































































100%|█████████▉| 398/400 [02:55<00:00,  2.36it/s]











































  9%|▉         | 9099/100000 [2:53:05<22:09:45,  1.14it/s]










































  9%|▉         | 9198/100000 [2:54:29<20:47:41,  1.21it/s]











































  9%|▉         | 9300/100000 [2:55:55<21:15:13,  1.19it/s]











































  9%|▉         | 9399/100000 [2:57:20<23:06:08,  1.09it/s]










































  9%|▉         | 9499/100000 [2:58:45<22:47:27,  1.10it/s]
 10%|▉         | 9500/100000 [2:58:46<21:48:00,  1.15it/s]






















































































 99%|█████████▉| 396/400 [02:52<00:01,  2.42it/s]


 10%|▉         | 9500/100000 [3:01:48<28:51:56,  1.15s/it]
{'train_runtime': 10912.933, 'train_samples_per_second': 9.163, 'train_steps_per_second': 9.163, 'train_loss': 2.2109533217580695, 'epoch': 0.18}
Training completed. Model saved. at  /l/users/abdelrahman.sadallah/nadi/core42/jais-13b-chat